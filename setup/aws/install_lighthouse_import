#/bin/bash

#
# curl https://raw.githubusercontent.com/WALL-E/static/master/setup/aws/install_lighthouse_import | bash
#
# wget https://raw.githubusercontent.com/WALL-E/static/master/setup/aws/install_lighthouse_import -O install_lighthouse_import
#
# install lighthouse to AWS Linux 2
#
# Network: mainnet
#


role=`id -u`
if test $role -ne 0
then
    echo "You install Docker which requires root privileges"
    exit 1
fi


VERSION=v1.4.0

cd ~

if [ ! -f "/usr/local/bin/lighthouse" ]
then
    wget https://github.com/sigp/lighthouse/releases/download/${VERSION}/lighthouse-${VERSION}-x86_64-unknown-linux-gnu-portable.tar.gz
    wget https://github.com/sigp/lighthouse/releases/download/${VERSION}/lighthouse-${VERSION}-x86_64-unknown-linux-gnu-portable.tar.gz.asc
    
    curl https://keybase.io/sigp/pgp_keys.asc | gpg --import
    gpg --verify \
      lighthouse-${VERSION}-x86_64-unknown-linux-gnu-portable.tar.gz.asc \
      lighthouse-${VERSION}-x86_64-unknown-linux-gnu-portable.tar.gz
      
    tar zxvf lighthouse-${VERSION}-x86_64-unknown-linux-gnu-portable.tar.gz
    mv lighthouse /usr/local/bin/
    lighthouse --version
    
    rm -f lighthouse-${VERSION}-x86_64-unknown-linux-gnu-portable.tar.gz
    rm -f lighthouse-${VERSION}-x86_64-unknown-linux-gnu-portable.tar.gz.asc
fi


lighthouse --network mainnet account validator import --directory $HOME --datadir /var/lib/lighthouse

echo "cat /var/lib/lighthouse/validators/validator_definitions.yml"
echo
echo "lighthouse --network mainnet account validator list --datadir /var/lib/lighthouse"
echo
